#!/bin/sh
case $BUTTON in
	1) st -e trizen -Syu & ;;
	2) notify-send "$(trizen -Qu)" & ;;
esac

if ! updates_arch=$(checkupdates 2> /dev/null | wc -l ); then
    updates_arch=0
fi

# if ! updates_aur=$(cower -u 2> /dev/null | wc -l); then
if ! updates_aur=$(trizen -Su --aur --quiet | wc -l); then
    updates_aur=0
fi

updates=$(("$updates_arch" + "$updates_aur"))

if [ "$updates" -gt 0 ]; then
    echo " $updates"
else
    echo "0"
fi

# for this block to work properly you will need to add the lines listed below to /etc/pacman.d/hooks/statusbar.hook

#[Trigger]
#Operation = Upgrade
#Type = Package
#Target = *
#
#[Action]
#Description = Updating statusbar...
#When = PostTransaction
#Exec = /usr/bin/pkill -RTMIN+2 dwmblocks
